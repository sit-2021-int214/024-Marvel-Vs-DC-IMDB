# Library
library(readr)
library(assertive)
library(stringr)
library(dplyr)
library(tidyr)
library(ggplot2)

# Dataset
prog_book <- read.csv("https://raw.githubusercontent.com/safesit23/INT214-Statistics/main/datasets/prog_book.csv")

glimpse(prog_book)



# 1.) ??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????? 300-400 ????????????
prog_book %>% filter(prog_book$Number_Of_Pages > 300 , prog_book$Number_Of_Pages < 400) %>% count() %>% rename(number_of_book = n)

# 2.) Type ????????????????????????????????????????????? Type ???????????????????????? Type ?????????????????????????????????????????? 
prog_book  %>% group_by(Type) %>% count() %>% rename(type_of_book = Type) %>% rename(number_of_each_type = n)

# 3.) ?????????????????????????????????????????????????????????????????? Type ?????????????????????????????????????????? 
prog_book  %>%  group_by(Type) %>% summarize(total_price = sum(Price , na.rm = TRUE))

# 4.) ???????????????????????????????????? Rating ????????????????????????????????????????????????????????????????????????????????????????????????????????????????????? 
minRating <- min(prog_book$Rating)
maxRating <- max(prog_book$Rating)
minRating
maxRating 

#minRatingBook
prog_book %>% select(Book_title , Rating) %>% filter(prog_book$Rating == minRating) 
#maxRatingBook
prog_book %>% select(Book_title , Rating) %>% filter(prog_book$Rating == maxRating) 

# 5.) ???????????????????????????????????????????????????????????????????????????????????? Type ???????????? Hardcover ?????????????????????????????????
prog_book %>% filter(prog_book$Type == 'Hardcover') %>% summarise(avg_of_price = mean(Price , na.rm = TRUE))
  
# 6.) ????????????????????????????????????????????????????????????????????? Reviews ????????????????????? Reviews ???????????????????????????????????????
#clean data 
prog_book$Reviews <- prog_book$Reviews %>% str_remove(",")
prog_book$Reviews <- as.numeric(prog_book$Reviews)
is.numeric(prog_book$Reviews)

# meanReview
meanReviews <- mean(prog_book$Reviews)
meanReviews

prog_book %>% select(Book_title , Reviews) %>% filter(prog_book$Reviews > meanReviews)

# part4
#???????????? type ????????????????????????????????? type_of_book
type_of_book <- prog_book  %>%  select(Type) %>% group_by(Type) %>% distinct(Type)
type_of_book

#???????????? price ????????????????????????????????? Type ??????????????? price_of_each_type
price_of_each_type <- prog_book  %>% group_by(Type) %>% select(Price,Type) %>% summarize(total_price = sum(Price , na.rm = TRUE))
price_of_each_type

#???????????????????????????????????? dataframe
lastPart <- data.frame(type=c(type_of_book),price=c(price_of_each_type))
lastPart
lastPart <- lastPart %>% select(-Type)
lastPart

#??????????????? barplot
barplot(lastPart$price.total_price , names.arg = lastPart$price.Type , main = "Total price of each Types" , xlab = "Type of book" , ylab = "Total Price")


